pdf('HBRRep1.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,97,99,100,101,102,106,107,108,110,112,113,114,115,116,119,121,122,125,126,128,129,131,132,133,134,135,137,138,139,142,143,147,148,150,152,153,155,160,162,163,164,166,170,172,173,174,175,176,184,185,196,197,198,200,203,205,212,213,214,218,220,226,236,278,304,323,335,364,366,369,433,501)
seq_uniqRead=c(124001,8030,1967,941,614,429,327,253,232,185,141,129,121,100,94,78,71,86,59,58,65,49,46,46,45,44,35,41,27,34,24,32,21,27,28,16,13,19,19,19,18,19,16,17,16,15,12,7,8,8,10,5,6,4,8,7,11,8,5,4,7,9,6,10,11,5,2,7,6,1,4,2,6,4,5,3,8,1,4,8,3,1,2,3,3,6,4,2,5,2,2,2,2,4,2,4,4,5,3,2,1,2,5,2,5,2,1,2,2,2,1,3,1,1,1,1,1,3,2,2,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,88,89,90,91,92,93,94,96,97,98,99,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,121,123,124,125,126,127,128,130,134,135,136,137,138,140,141,142,144,145,151,152,155,156,160,161,162,167,168,169,172,175,178,180,181,182,185,187,189,194,201,202,203,204,211,213,216,217,225,228,230,233,246,247,268,292,311,328,343,364,380,398,468,543)
pos_uniqRead=c(114745,8386,2137,1009,670,476,323,251,241,207,170,133,127,107,89,88,75,69,77,49,60,64,53,53,40,40,45,36,39,34,26,31,31,27,24,28,20,10,20,10,23,19,15,18,14,23,16,12,12,9,10,10,4,14,8,4,7,5,7,5,10,6,10,3,2,7,12,3,6,8,2,4,3,5,7,2,3,11,3,1,7,1,6,1,3,3,1,6,3,5,7,1,6,2,4,3,3,2,1,3,3,4,2,1,5,2,2,1,1,1,4,2,1,2,1,4,1,2,1,1,1,1,2,1,1,1,1,1,2,1,1,3,2,2,2,2,2,1,1,1,1,2,1,1,1,1,1,2,2,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
