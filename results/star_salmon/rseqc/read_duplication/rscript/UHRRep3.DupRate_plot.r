pdf('UHRRep3.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,118,119,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,143,144,146,147,148,149,150,151,152,153,154,155,156,159,160,161,162,165,166,168,169,170,171,172,173,174,175,176,178,179,180,183,186,188,189,190,191,192,193,194,195,196,200,202,203,205,207,208,216,218,221,226,227,228,237,238,240,241,242,243,244,247,249,253,254,257,258,266,276,280,282,283,287,293,307,315,328,343,357,383,416,421,429,450,473,666,914)
seq_uniqRead=c(167681,11505,3534,1718,979,730,532,381,337,279,218,228,175,137,127,128,110,111,106,89,67,76,77,63,70,62,60,59,44,44,51,44,47,45,41,36,39,31,19,23,35,38,35,19,18,19,17,14,17,23,10,19,7,14,15,19,11,18,10,11,13,12,10,7,10,13,7,10,10,6,7,6,12,8,7,6,10,11,6,11,8,5,6,10,7,5,8,2,8,5,6,9,3,7,7,5,1,2,4,9,2,4,3,3,8,4,7,3,1,2,4,5,1,3,3,3,2,5,1,8,2,5,2,3,5,3,3,2,2,2,3,2,2,1,1,1,1,4,2,1,2,4,1,1,1,2,1,2,2,2,1,3,1,1,2,4,3,2,1,1,1,1,2,2,2,1,1,2,2,1,1,2,1,1,2,2,1,1,1,2,1,2,1,1,1,1,2,1,1,1,1,3,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,128,129,130,131,132,133,134,136,137,138,139,140,141,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,161,162,163,164,165,167,168,169,170,171,172,173,175,179,180,181,183,185,186,187,188,189,191,192,194,195,196,197,198,200,201,202,203,204,205,206,210,211,212,214,215,217,218,220,221,226,229,232,236,240,242,243,245,248,255,257,258,260,261,262,267,268,273,274,275,287,302,303,304,323,332,373,377,378,383,386,405,439,460,465,488,541,722,998)
pos_uniqRead=c(148162,12017,3716,1825,1073,724,604,405,346,300,252,224,179,153,144,155,117,107,82,101,94,67,85,78,76,64,64,56,55,47,49,48,49,53,30,49,39,43,29,29,27,28,30,33,28,28,20,21,21,17,19,16,14,12,15,20,10,16,9,13,13,12,15,18,9,3,13,9,10,14,14,14,5,3,5,7,5,5,11,7,9,11,6,6,8,11,6,11,6,2,5,11,5,9,3,5,6,2,5,7,5,4,1,3,10,3,3,9,6,6,2,6,4,5,6,2,5,1,2,1,1,1,4,1,3,2,3,3,4,2,2,3,3,5,3,3,3,4,3,3,2,2,3,1,4,2,1,1,1,2,1,3,2,1,4,2,2,1,1,1,2,4,1,1,1,2,4,2,1,1,1,1,2,1,2,2,2,1,1,1,1,1,1,1,1,2,2,1,3,1,2,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,2,1,1,1,3,1,1,1,1,1,1,2,1,2,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
