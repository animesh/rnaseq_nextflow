pdf('HBRRep3.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,118,119,120,121,122,124,126,127,129,131,135,136,138,140,141,142,143,144,147,151,157,158,159,161,162,163,166,167,171,172,173,174,175,176,178,179,181,182,185,187,189,193,201,208,218,223,225,227,231,237,238,239,242,250,257,276,284,288,323,332,344,381,382,416,522)
seq_uniqRead=c(134860,8662,2152,1023,618,421,351,274,223,184,177,140,139,106,94,100,80,63,54,56,62,68,46,37,43,43,42,39,35,36,27,28,29,30,24,24,26,15,20,17,15,12,16,20,14,14,13,8,16,16,18,11,15,9,9,7,12,8,8,5,2,6,10,5,3,4,8,8,7,2,8,9,6,7,2,3,5,4,5,2,4,6,4,2,3,4,1,2,2,2,5,6,1,4,2,3,1,2,1,2,1,3,5,1,4,1,4,3,4,1,1,1,1,2,4,1,2,3,1,2,1,1,2,3,2,1,1,2,1,2,1,1,1,2,3,1,1,3,4,1,3,1,1,2,1,1,1,1,2,2,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,105,106,107,108,109,110,111,112,113,114,116,117,118,119,120,121,122,123,125,126,127,128,129,131,132,134,135,136,137,140,143,145,146,148,151,152,153,154,156,157,160,164,165,168,170,171,172,175,176,177,178,179,180,184,186,187,189,191,192,194,195,199,200,203,205,208,215,228,237,240,242,250,255,257,258,263,272,289,291,297,306,362,365,377,399,435,463,487,563)
pos_uniqRead=c(124502,9338,2229,1091,649,443,353,277,262,188,188,140,147,132,111,88,84,84,56,51,65,58,52,42,42,44,38,50,20,49,33,30,36,33,25,20,17,29,24,21,18,17,13,10,14,23,11,19,10,19,8,11,15,9,16,11,16,8,8,8,5,7,8,5,7,2,6,8,5,1,5,7,6,6,7,4,8,3,5,6,6,5,5,5,2,1,4,2,3,3,1,4,2,1,1,5,6,6,4,2,2,2,2,1,2,2,2,2,1,4,3,1,2,2,3,1,3,2,5,1,3,3,1,2,3,1,1,2,1,1,2,1,1,1,1,2,1,1,2,1,1,1,1,1,2,2,1,2,2,1,2,1,1,1,1,4,1,2,1,1,2,2,2,1,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
