pdf('HBRRep2.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,109,110,111,112,115,116,117,118,119,120,122,123,124,125,126,127,128,129,130,132,133,134,135,136,138,141,142,144,145,146,147,148,150,151,152,154,155,156,161,162,164,166,167,171,172,175,176,177,181,184,188,191,192,193,194,196,197,198,199,204,205,210,211,214,220,224,226,231,232,238,242,244,252,253,254,255,275,282,291,306,318,319,354,372,396,398,541,686)
seq_uniqRead=c(146892,10060,2562,1156,693,487,372,281,240,229,201,141,144,124,98,94,108,76,69,57,61,52,54,56,52,41,43,39,34,33,35,41,33,35,26,25,19,28,30,24,10,16,17,19,17,19,14,20,14,9,15,8,9,14,10,7,14,11,12,9,6,10,9,7,6,4,1,8,8,4,4,4,6,3,9,3,3,4,7,2,12,5,7,6,4,3,8,4,5,8,5,4,3,2,2,1,2,2,4,1,3,1,2,3,4,2,2,1,1,1,1,6,2,2,1,2,2,1,2,1,1,2,2,1,1,1,2,1,3,1,1,2,2,1,2,1,2,1,2,2,2,1,1,2,2,1,1,1,1,1,1,2,1,1,1,2,2,1,2,1,1,1,1,1,3,2,1,2,1,3,1,1,1,1,1,1,1,3,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,117,118,120,121,122,123,124,125,126,127,128,131,132,133,134,136,137,138,139,140,142,143,144,145,147,148,149,150,154,156,157,158,160,161,164,165,166,167,169,170,172,173,174,177,181,182,187,188,191,193,194,195,200,204,205,208,209,210,211,212,214,215,216,221,222,223,224,225,231,233,238,239,242,244,252,254,257,262,263,268,272,275,277,284,290,293,302,303,333,338,377,395,414,433,457,593,732)
pos_uniqRead=c(135212,10750,2717,1217,734,537,389,282,248,210,192,187,140,118,114,100,100,105,79,67,56,63,54,49,50,62,46,47,41,27,28,31,32,33,22,39,32,32,28,27,22,17,16,15,18,10,19,13,16,13,17,13,12,10,15,6,9,10,16,13,8,12,12,11,8,8,8,1,4,2,9,7,3,4,5,9,4,4,3,5,1,4,6,5,5,4,3,4,9,7,4,6,2,3,3,6,5,4,3,4,4,2,4,2,1,2,1,3,1,3,2,2,3,2,1,2,1,2,3,3,1,2,1,2,1,3,1,1,2,1,1,1,1,2,3,3,1,2,1,1,2,1,1,1,2,2,1,5,2,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,3,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
